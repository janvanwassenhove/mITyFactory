# GitHub Copilot Instructions for {{app_name}}

## Project Overview

{{app_name}} is a Java Spring Boot application generated by mITyFactory.

## Tech Stack

- **Backend**: Java 21
- **Framework**: Spring Boot 3.x
- **Build**: Maven
- **Testing**: JUnit 5, Mockito
- **Database**: JPA/Hibernate

## Project Structure

```
{{app_name}}/
├── src/
│   ├── main/
│   │   ├── java/
│   │   │   └── com/example/{{app_name}}/
│   │   │       ├── Application.java
│   │   │       ├── controller/      # REST controllers
│   │   │       ├── service/         # Business logic
│   │   │       ├── repository/      # Data access
│   │   │       ├── model/           # Entity classes
│   │   │       ├── dto/             # Data transfer objects
│   │   │       └── config/          # Configuration classes
│   │   └── resources/
│   │       └── application.yml
│   └── test/
│       └── java/                    # Test classes
├── docs/
│   └── architecture/               # Architecture documentation
├── .specify/                       # Spec Kit (constitution, principles, features)
└── .github/                        # GitHub configuration
```

---

## Code Style Rules

### Java Conventions

- Follow Google Java Style Guide
- Use meaningful, descriptive names
- Prefer composition over inheritance
- Use dependency injection (constructor injection preferred)

### Spring Boot Patterns

```java
// Controller
@RestController
@RequestMapping("/api/v1/items")
public class ItemController {
    private final ItemService itemService;

    public ItemController(ItemService itemService) {
        this.itemService = itemService;
    }

    @GetMapping("/{id}")
    public ResponseEntity<ItemDto> getItem(@PathVariable Long id) {
        return ResponseEntity.ok(itemService.findById(id));
    }
}

// Service
@Service
@Transactional
public class ItemService {
    private final ItemRepository itemRepository;

    public ItemService(ItemRepository itemRepository) {
        this.itemRepository = itemRepository;
    }
}
```

### Exception Handling

```java
@RestControllerAdvice
public class GlobalExceptionHandler {
    @ExceptionHandler(EntityNotFoundException.class)
    public ResponseEntity<ErrorResponse> handleNotFound(EntityNotFoundException ex) {
        return ResponseEntity
            .status(HttpStatus.NOT_FOUND)
            .body(new ErrorResponse(ex.getMessage()));
    }
}
```

---

## Testing Requirements

### Unit Tests

- Test all service methods in isolation
- Use Mockito for mocking dependencies
- Target 80%+ coverage

### Integration Tests

- Use `@SpringBootTest` for full context tests
- Use `@WebMvcTest` for controller-only tests
- Use Testcontainers for database tests

### Running Tests

```bash
# All tests
./mvnw test

# With coverage
./mvnw test jacoco:report

# Specific class
./mvnw test -Dtest=ItemServiceTest
```

---

## API Design Guidelines

1. **RESTful conventions**: Use proper HTTP methods
2. **Versioning**: Prefix routes with `/api/v1/`
3. **Response format**: Use consistent JSON structure with DTOs
4. **Pagination**: Use `Pageable` for list endpoints
5. **Validation**: Use Bean Validation annotations

---

## Factory Alignment

This application follows mITyFactory principles:

1. **Spec-driven**: All features defined in `.specify/features/`
2. **Container-first**: Runs in Docker containers
3. **Deterministic**: Reproducible builds with Maven
4. **Quality gates**: Tests, lints, and security checks

---

## DO ✓

- Use constructor injection for dependencies
- Write tests for new features
- Follow the spec in `.specify/` for feature definitions
- Use `application.yml` for configuration
- Document REST endpoints with OpenAPI annotations

## DON'T ✗

- Use field injection (`@Autowired` on fields)
- Hardcode configuration values
- Commit secrets to the repository
- Skip input validation
- Use raw SQL without parameterization
